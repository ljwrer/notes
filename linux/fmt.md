# 格式化输出

- nl – 添加行号
- fold – 限制文件列宽
- fmt – 一个简单的文本格式转换器
- pr – 让文本为打印做好准备
- printf – 格式化数据并打印出来
- groff – 一个文件格式化系统



### 简单的格式化工具

#### nl - 添加行号

```bash
[me@linuxbox ~]$ nl distros.txt | head
```

像 cat，nl 既能接受多个文件作为命令行参数，也能接受标准输入

*nl 标记*

| 标记   | 含义             |
| ------ | ---------------- |
| \:\:\: | 逻辑页页眉开始处 |
| \:\:   | 逻辑页主体开始处 |
| \:     | 逻辑页页脚开始处 |

 *常用 nl 选项*

| 选项      | 含义                                                         |
| --------- | ------------------------------------------------------------ |
| -b style  | 把 body 按被要求方式数行，可以是以下方式：a = 数所有行t = 数非空行。这是默认设置。n = 无pregexp = 只数那些匹配了正则表达式的行 |
| -f style  | 将 footer 按被要求设置数。默认是无                           |
| -h style  | 将 header 按被要求设置数。默认是                             |
| -i number | 将页面增加量设置为数字。默认是一。                           |
| -n format | 设置数数的格式，格式可以是：ln = 左偏，没有前导零。rn = 右偏，没有前导零。rz = 右偏，有前导零。 |
| -p        | 不要在没一个逻辑页面的开始重设页面数。                       |
| -s string | 在没一个行的末尾加字符作分割符号。默认是单个的 tab。         |
| -v number | 将每一个逻辑页面的第一行设置成数字。默认是一。               |
| -w width  | 将行数的宽度设置，默认是六。                                 |

#### fold - 限制文件行宽

 fold 接受一个或多个文件及标准输入

```bash
# 默认80
[me@linuxbox ~]$ echo "The quick brown fox jumped over the lazy dog." | fold -w 12
```

```bash
# -s 选项将让 fold 分解到最后可用的空白 字符，即会考虑单词边界
[me@linuxbox ~]$ echo "The quick brown fox jumped over the lazy dog."
| fold -w 12 -s
```

#### fmt - 一个简单的文本格式器

接受文本或标准输入并且在文本流上呈现照片转换。它主要是填充和连接文本行，同时保留空白符和缩进。

```bash
[me@linuxbox ~]$ fmt -w 50 fmt-info.txt | head
```

fmt 会保留第一行的缩进，-c避免这种行为

```bash
#  -p 格式指定内容，如注释
[me@linuxbox ~]$ fmt -w 50 -p '# ' fmt-code.txt
```

#### pr – 格式化打印文本

pr 程序用来把文本分页

```bash
#  -l 选项（页长）和 -w 选项（页宽）定义了宽65列，长15行的一个“页面”
[me@linuxbox ~]$ pr -l 15 -w 65 distros.txt
```

#### printf – Format And Print Data

printf 并不用于流水线执行（不接受标准输入），最初为 C 语言设计，后来在包括 shell 的多种语言中运用

```bash
$ printf “format” arguments
```

*printf 转换规范组件*

| 组件 | 描述                                        |
| ---- | ------------------------------------------- |
| d    | 将数字格式化为带符号的十进制整数            |
| f    | 格式化并输出浮点数                          |
| o    | 将整数格式化为八进制数                      |
| s    | 将字符串格式化                              |
| x    | 将整数格式化为十六进制数，必要时使用小写a-f |
| X    | 与 x 相同，但变为大写                       |
| %    | 打印 % 符号 (比如，指定 “%%”)               |

```bash
 [me@linuxbox ~]$ printf "%d, %f, %o, %s, %x, %X\n" 380 380 380 380 380 380380, 380.000000, 574, 380, 17c, 17C
```

```bash
%[flags][width][.precision]conversion_specification
```

 *printf 转换规范组件*

| 组件       | 描述                                                         |
| ---------- | ------------------------------------------------------------ |
| flags      | 有5种不同的标志:# – 使用“备用格式”输出。这取决于数据类型。对于o（八进制数）转换，输出以0为前缀.对于x和X（十六进制数）转换，输出分别以0x或0X为前缀。0–(零) 用零填充输出。这意味着该字段将填充前导零，比如“000380”。- – (破折号) 左对齐输出。默认情况下，printf右对齐输出。‘ ’ – (空格) 在正数前空一格。+ – (加号) 在正数前添加加号。默认情况下，printf 只在负数前添加符号。 |
| width      | 指定最小字段宽度的数。                                       |
| .precision | 对于浮点数，指定小数点后的精度位数。对于字符串转换，指定要输出的字符数。 |

*print 转换规范示例*

| 自变量      | 格式      | 结果        | 备注                                                         |
| ----------- | --------- | ----------- | ------------------------------------------------------------ |
| 380         | "%d"      | 380         | 简单格式化整数。                                             |
| 380         | "%#x"     | 0x17c       | 使用“替代格式”标志将整数格式化为十六进制数。                 |
| 380         | "%05d"    | 00380       | 用前导零（padding）格式化整数，且最小字段宽度为五个字符。    |
| 380         | "%05.5f"  | 380.00000   | 使用前导零和五位小数位精度格式化数字为浮点数。由于指定的最小字段宽度（5）小于格式化后数字的实际宽度，因此前导零这一命令实际上没有起到作用。 |
| 380         | "%010.5f" | 0380.00000  | 将最小字段宽度增加到10，前导零现在变得可见。                 |
| 380         | "%+d"     | +380        | 使用+标志标记正数。                                          |
| 380         | "%-d"     | 380         | 使用-标志左对齐                                              |
| abcdefghijk | "%5s"     | abcedfghijk | 用最小字段宽度格式化字符串。                                 |
| abcdefghijk | "%d"      | abcde       | 对字符串应用精度，它被从中截断。                             |

### 文件格式化系统

两个文件格式化程序的主要家族占据了该领域：继承自原始 roff 程序的，包括 nroff 和 troff；以及 基于 Donald Knuth 的 TEX（发音“tek”）排版系统

#### groff

groff 是一套用GNU实现 troff 的程序

> 在图形文字处理器出现之前，需要两步来生成文档。首先用文本编辑器排字，接着用诸如 troff 之类的处理器来格式化。 格式化程序的说明通过标记语言的形式插入到已排好字的文本当中。 



```bash
[me@linuxbox ~]$ man ls | head
[me@linuxbox ~]$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc -T ascii | head
[me@linuxbox ~]$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc | head
# groff 可以产生多种格式的输出。 如果没有指定格式，默认情况下会输出 PostScript格式
[me@linuxbox ~]$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc >
~/Desktop/foo.ps
```

> PostScript 是一种页面描述语言，用于将打印页面的内容描述给类似排字机的设备

```bash
# 将 PostScript 输出的文件转换为PDF
[me@linuxbox ~]$ ps2pdf ~/Desktop/foo.ps ~/Desktop/ls.pdf
```