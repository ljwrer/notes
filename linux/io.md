# 5. I/O 重定向

 - cat － 连接文件
 - sort － 排序文本行
 - uniq － 报道或省略重复行
 - grep － 打印匹配行
 - wc － 打印文件中换行符，字，和字节个数
 - head － 输出文件第一部分
 - tail - 输出文件最后一部分
 - tee - 从标准输入读取数据，并同时写到标准输出和文件

与 Unix 主题“任何东西都是一个文件”保持一致，程序，比方说 ls，实际上把他们的运行结果 输送到一个叫做标准输出的特殊文件（经常用 stdout 表示），而它们的状态信息则送到另一个 叫做标准错误的文件（stderr）。默认情况下，标准输出和标准错误都连接到屏幕，而不是 保存到磁盘文件。除此之外，许多程序从一个叫做标准输入（stdin）的设备得到输入，默认情况下， 标准输入连接到键盘。

I/O 重定向允许我们更改输出地点和输入来源。一般地，输出送到屏幕，输入来自键盘， 但是通过 I/O 重定向，我们可以做出改变。

## 标准输出重定向
使用 “>” 重定向符后接文件名将标准输出重定向到除屏幕以外的另一个文件
```
ls -l /usr/bin > ls-output.txt
# 清空一个文件内容
> ls-output.txt
```

使用”>>“重定向符把重定向结果追加到文件内容后面
```
ls -l /usr/bin >> ls-output.txt
```

## 标准错误重定向

一个程序可以在几个编号的文件流中的任一个上产生输出。虽然我们已经将这些文件流的前 三个称作标准输入、输出和错误，shell 内部分别将其称为文件描述符0、1和2。shell 使用文件描述符提供了一种表示法来重定向文件
```
ls -l /bin/usr 2> ls-error.txt
```

## 重定向标准输出和错误到同一个文件
```
ls -l /bin/usr > ls-output.txt 2>&1
```
标准错误的重定向必须总是出现在标准输出重定向之后

更精简的方法
```
ls -l /bin/usr &> ls-output.txt
```

## 处理不需要的输出
系统通过重定向输出结果到一个叫做”/dev/null”的特殊文件，这个文件是系统设备，叫做位存储桶，它可以 接受输入，并且对输入不做任何处理
```
ls -l /bin/usr 2> /dev/null
```

## cat － 连接文件
cat 命令读取一个或多个文件，然后复制它们到标准输出
```
cat [file]
```
可以使用 cat 来显示 文件而没有分页
```
cat ls-output.txt
```
 cat 可以 接受不只一个文件作为参数，所以它也可以用来把文件连接在一起
```
cat movie.mpeg.0* > movie.mpeg
```
如果 cat 没有给出任何参数，它会从标准输入读入数据，又因为标准输入默认情况下连接到键盘
```
cat
# 输入 Ctrl-d（按住 Ctrl 键同时按下”d”），来告诉 cat，在标准输入中， 它已经到达文件末尾（EOF）
```
重定向标准输入
```
cat < lazy_dog.txt
```
使用“<”重定向操作符，我们把标准输入源从键盘改到文件 lazy_dog.txt结果和传递单个文件名作为参数的执行结果一样

## 管道线
命令从标准输入读取数据并输送到标准输出的能力被一个称为管道线的 shell 特性所利用。 使用管道操作符”|”（竖杠），一个命令的标准输出可以通过管道送至另一个命令的标准输入
```
command1 | command2
ls -l /usr/bin | less
```

## 过滤器
管道线经常用来对数据完成复杂的操作。有可能会把几个命令放在一起组成一个管道线。 通常，以这种方式使用的命令被称为过滤器。过滤器接受输入，以某种方式改变它，然后 输出它。
```
ls /bin /usr/bin | sort | less
```

## uniq - 报道或忽略重复行
uniq 命令经常和 sort 命令结合在一起使用。uniq 从标准输入或单个文件名参数接受数据有序列表，默认情况下，从数据列表中删除任何重复行。
```
ls /bin /usr/bin | sort | uniq | less
# 带上”-d”选项查看重复的数据列表
ls /bin /usr/bin | sort | uniq -d | less
```

## wc － 打印行数、字数和字节数
```
wc ls-output.txt
```
”-l”选项限制命令输出只能 报道行数
```
ls /bin /usr/bin | sort | uniq | wc -l
```

## grep － 打印匹配行
当 grep 遇到一个文件中的匹配”模式”，它会打印出包含这个类型的行

grep支持正则表达式
”-i”使得 grep 在执行搜索时忽略大小写（通常，搜索是大小写 敏感的），”-v”选项会告诉 grep 只打印不匹配的行

```
grep pattern [file...]
```

### 搜索
```
ls /bin /usr/bin | sort | uniq | grep zip
```

## head / tail － 打印文件开头部分/结尾部分
head 命令打印文件的前十行，而 tail 命令打印文件的后十行。默认情况下，两个命令 都打印十行文本，但是可以通过”-n”选项来调整命令打印的行数
```
head -n 5 ls-output.txt

tail -n 5 ls-output.txt

# 在管道线中
ls /usr/bin | tail -n 5
```

tail 有一个选项允许你实时地浏览文件。当观察日志文件的进展时，这很有用，因为 它们同时在被写入。在以下的例子里，我们要查看目录/var/log 里面的信息文件。  
Ctrl-c退出
```
tail -f /var/log/messages
```

## tee － 从 Stdin 读取数据，并同时输出到 Stdout 和文件
制造了 一个”tee”，安装到我们的管道上。tee 程序从标准输入读入数据，并且同时复制数据 到标准输出（允许数据继续随着管道线流动）和一个或多个文件。当在某个中间处理 阶段来捕捉一个管道线的内容时，这很有帮助
```
ls /usr/bin | tee ls.txt | grep zip
```

>几乎所有的命令行 程序都使用标准错误来显示它们的详细信息